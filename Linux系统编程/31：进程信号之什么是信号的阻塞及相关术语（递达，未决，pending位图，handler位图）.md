 

- [专栏目录首页：【专栏必读】王道考研408操作系统+Linux系统编程万字笔记、题目题型总结、注意事项、目录导航和思维导图](https://zhangxing-tech.blog.csdn.net/article/details/121004242)

### 文章目录

- - [（1）信号相关术语](#1_5)
  - [（2）信号在内核中的表示](#2_14)

  
前面说过，操作系统发出信号之后，对于进程有可能不是立马就处理的，所以如果不是立即处理，那么在这个空档期间进程究竟对信号做了怎样的处理呢？

## （1）信号相关术语

为了表示清楚，这里总结关于信号的一些术语

- **递达（Delivery）**：进程执行信号的处理动作
- **信号未决（Pending）**：信号从产生到递达之间的状态
- **阻塞（Block）**：进程可以选择对信号进行阻塞，被阻塞的信号产生时将保持在未决状态，知道进程解除对此信号的阻塞，才会执行递达动作

需要注意区分**阻塞和忽略**，递达有三种可选动作——忽略，执行默认，自定义捕捉，所以忽略是也就是递达了，但是阻塞是保持在了未决

## （2）信号在内核中的表示

我们一切的叙述都是围绕进程来展开的，管理进程对应的数据结构式`task_struct`，而`task_struct`中又会涉及到各种各样的结构（比如之前的`files struct`）。  
前面说过操作系统对进程发送信号的动作实际应该表述为写入，**其实每个信号都有两个标志位分别表示阻塞和未决，还有一个函数指针来表示处理的动作**，如下  
![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20210412104535128.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5MTgzMDM0%2Csize_16%2Ccolor_FFFFFF%2Ct_70&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F116277610)

**大家可以看到，从1号信号（`SIGHUP`）开始，每个信号都对应`block`位图，`pending`位图和`handler`数组（它是一个函数指针数组，每个函数指针指向一个函数，表示处理的动作）的一位或下标。一旦信号产生，操作系统会在`task_struct`中设置该信号的未决状态，也就是说如果操作系统给某个进程发送了3号信号，那么就会把这个进程的`task_struct`中的`pending`位图中的第三个位置为1，此时信号处于未决状态还没有递达，一旦信号递达，操作系统就会将该标志位置为0。而`block`位图中，一旦把第n位设置为了1，表示n号信号被阻塞，需要注意的是无论这个信号是否产生，它都可以被阻塞。**

- `SIGHUP`信号产生过，也未被阻塞，所以当此信号递达时将会执行默认动作
- `SIGINT`信号产生过，但是正在被阻塞，所以暂时无法递达，它的处理动作是忽略，但是在没有接触阻塞之前是不能忽略这个信号的，因为进程仍然有机会改变处理动作再接触阻塞
- `SIGQUIT`信号没有产生过，一旦产生就会被阻塞，它的处理动作是用户自定义的一个函数。