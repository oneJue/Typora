 

- [指导获取：密码7281](https://url18.ctfile.com/f/22722418-803125355-edf378)
- [专栏目录首页：【专栏必读】王道考研408计算机网络+湖科大教书匠计算机网络+网络编程万字笔记、题目题型总结、注意事项、目录导航和思维导图](https://zhangxing-tech.blog.csdn.net/article/details/125668174)
- [王道考研408计算机组成原理万字笔记](https://zhangxing-tech.blog.csdn.net/article/details/120664162?spm=1001.2014.3001.5502)
- [王道考研408数据结构+计算机算法设计与分析万字笔记](https://blog.csdn.net/qq_39183034/article/details/121501138?spm=1001.2014.3001.5501)
- [王道考研408操作系统+Linux系统编程万字笔记](https://zhangxing-tech.blog.csdn.net/article/details/121004242?spm=1001.2014.3001.5502)

### 文章目录

- [一：子网划分和子网掩码](#_9)
- - [（1）子网划分](#1_11)
  - [（2）子网掩码](#2_44)
- [二：使用子网掩码时路由器分组转发算法](#_67)
- [三：无分类域间路由选择CIDR](#CIDR_78)
- [四：构成超网（路由聚合）](#_104)
- [五：最长匹配前缀](#_115)

# 一：子网划分和子网掩码

## （1）子网划分

**传统的两级IP地址存在很大的缺点，表现为**：

- IP地址空间的利用率有时会很低
- 给每个物理网络分配一个网络号会使得路由表变得太大而使网络性能变坏
- 两级的IP地址不够灵活

**子网划分：IP地址中会增加一个子网号字段，使两级IP地址变成了三级IP地址。子网划分的基本思路如下**

- 子网划分纯属一个单位内部的事情。单位**对外仍然表现为没有划分子网的网络**
- 从主机号借用若干比特作为子网号，当然主机号也就相应减少了相同的比特。三级IP地址的结构如下: **IP地址= \{\<网络号>,\<子网号>,\<主机号>\}**
- 凡是从其他网络发送给本单位某台主机的IP数据报，仍然是根据IP数据报的目的网络号，**先找到连接到本单位网络上的路由器**；然后该路由器在收到IP数据报后，按目的网络号和子网号**找到目的子网**；最后把IP数据报直接交付给**目的主机**

**特别注意**

- 对分类的IPv4地址进行子网划分时，**子网号不能为全1或全0**（但随着CIDR的广泛使用，现在全1和全0的子网号也可使用，但一定要谨慎使用，要弄清你的路由器所用的路由选择软件是否支持全0或全1的子网号）
- 不论是分类的IPv4 地址还是CIDR，其子网中的**主机号为全0或全1的地址都不能被指派**
- 子网中主机号全0的地址为子网的网络号，主机号全1的地址为子网的广播地址

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2Ff31cc31cda034db6bce7fdf8fcbc2e71.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)

## （2）子网掩码

**子网掩码：子网掩码是一个与IP地址相对应的、长32bit的二进制串,它由一串1和跟随的一串0组成。其中，1对应于IP地址中的网络号及子网号，而0对应于主机号。计算机只需将IP地址和其对应的子网掩码逐位“与”\(逻辑AND运算\)，就可得出相应子网的网络地址**

- 例如某主机IP地址为`192.168.5.56`，子网掩码为`255.255.255.0`，按位与后得出该主机所在子网的网络号为：`192.168.5.0`

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2F4a38aeefb30b4508b092dc4f427f8ee3.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)  
**因特网规定，所有网络都必须使用子网掩码，若一个网络未划分子网，那么就采用默认子网掩码**

- A A A类默认子网掩码：255.0.0.0
- B B B类默认子网掩码：255.255.0.0
- A A A类默认子网掩码：255.255.255.0

**在使用子网掩码的情况下**

- 一台主机在设置IP地址信息的同时，必须设置子网掩码
- 同属于一个子网的所有主机及路由器的相应端口，必须设置相同的子网掩码
- 路由器的路由表中，所包含信息的主要内容必须有目的网络地址、子网掩码、下一 跳地址

# 二：使用子网掩码时路由器分组转发算法

1.  从收到的分组的首部提取**目的IP地址**，记为D
2.  先判断是否为**直接交付**。对路由器直接相连的网络逐个进行检查:用各网络的子网掩码和D逐位相“与”，看结果是否和相应的网络地址匹配。**若匹配，则将分组直接交付，否则间接交付**，执行步骤3
3.  若路由表中有目的地址为D的特定主机路由，**则将分组传送给路由表中所指明的下一跳路由器**；否则，执行4\)
4.  对路由表中的每一行\( 目的网络地址、子网掩码、下一跳地址\)中的子网掩码和D逐位相“与”，其结果为N。**若N与该行的目的网络地址匹配，则将分组传送给该行指明的下一跳路由器**；否则，执行步骤5\)。
5.  若路由表中有一个默认路由，**则将分组传送给路由表中所指明的默认路由器;否则**，执行步骤6\)
6.  报告转发分组出错（生存时间已到）

# 三：无分类域间路由选择CIDR

**无分类域间路由选择CIDR：是在变长子网掩码的基础上提出的一种消除传统 A A A、 B B B、 C C C类网络划分，并且可以在软件的支持下实现超网构造的一种 IP地址的划分方法，具体来说**

**①：消除传统 A A A、 B B B、 C C C类地址及划分子网的概念，因而可以更有效地分配IPv4的地址空间**：CIDR使用**网络前缀**的概念代替子网络的概念，因此IP地址的无分类两级编址为：**IP::=\{\<网络前缀>，\<主机号>\}**

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2F8b79f57adc3d4a0885c1c7f6039d8a4e.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)  
**②：CIDR使用“斜线记法”，即IP地址/网络前缀所占比特数**：其中网络前缀所占比特数对应**网络号**部分，等效于子网掩码中**连续1**的部分。例如对于`128.14.32.5/20`这个地址，它的掩码是20个连续的1和后续12个连续的0，通过逐位相与的方法可以得到该地址网络前缀（或直接截取前20位）

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2Fcf0abcb260994c85bc32afdd0066b616.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2F3dac71787e384451b27b778bee5ae624.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)

**③：CIDR虽然不使用子网，但仍然使用“掩码”一词**：“CIDR不使用子网”是指**CIDR并没有在32位地址中指明若干位作为子网字段**。但分配到一个CIDR地址块的组织，**仍可以在本组织内根据需要划分出一些子网**。 例如，某组织分配到地址块`/20`，就可以再继续刬分为8个子网\(从主机号中借用3位来划分子网\)，这时每个子网的网络前缀就变成了23位。全0和全1的主机号地址一般不使用

**④：CIDR将网络前缀都相同的连续IP地址组成“CIDR地址块”**：例如128.14.35.7/20是某CIDR地址块中的一个地址

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2Fdf912ec720e04f249767d6c9cd8c7361.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)

# 四：构成超网（路由聚合）

**构成超网（路由聚合）：是指将多个子网聚合成一个较大的子网（通过将网络前缀缩短**

- 如下图，如果不使用路由聚合，那么 R 1 R1 R1的路由表中需要分别有到网络1和网络2的路由表项。这里网络1和网络2的前16位是相同的，从第17位开始分别是0和1，并且从 R 1 R1 R1到网络1和网络2的路由的吓一跳皆为 R 2 R2 R2
- 如果使用路由聚合，那么在 R 1 R1 R1看来，网络1和网络2可以构成一个更大的地址块即`206.1.0.0/16`，到网络1和网络2的两条路由就可以聚合成一条到`206.1.0.0/16`的路由

![在这里插入图片描述](https://ziquyun.com/main/csdn/img?url=https%3A%2F%2Fimg-blog.csdnimg.cn%2Ff3d29d8a80ed477d802ae34277e507f2.png&rfUrl=https%3A%2F%2Fzhangxing-tech.blog.csdn.net%2Farticle%2Fdetails%2F125348701)

# 五：最长匹配前缀

**最长匹配前缀：使用CIDR 时，路由表中的每个项目由“网络前缀”和“下一跳地址”组成。在查找路由表时可能会得到不止一个匹配结果。此时，应当从匹配结果中选择具有最长网络前缀的路由，因为网络前缀越长，其地址块就越小，因而路由就越具体**